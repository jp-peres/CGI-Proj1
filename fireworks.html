<!DOCTYPE html>
<html>
<head>
<script id="vertex-shader-fragments" type="x-shader/x-vertex">
// 1st explosion
attribute float vETime;
attribute vec2 vEVel;
// 2nd explosion
attribute float vE1Time;
attribute vec2 vE1Vel;

attribute vec4 vPosition;
attribute vec2 vInitVel;
attribute float vInitialTime;
attribute vec4 vColor;
varying vec4 fColor;

uniform float uTime;
uniform float uAceleration;
uniform float uVelocityFactor;

void test(float v, vec2 derp){
    
}
void test2(float v){

}
void test3(vec4 v){

}

vec2 currentPos(float currTime){
    float x, y, movTime;
    x = vPosition.x + ((uVelocityFactor*vInitVel.x)*currTime);
    y = vPosition.y + ((uVelocityFactor*vInitVel.y)*currTime) + (0.5*uAceleration*currTime*currTime);
    if (currTime>=vETime){
        movTime = currTime - vETime;
        // explosion position
        x = x + (((uVelocityFactor/1.5)*vEVel.x)*movTime);
        y = y + ((uVelocityFactor*vEVel.y)*movTime) + (0.5*uAceleration*movTime*movTime);
    }
    if (currTime>=(vE1Time*500000.0)) {
        movTime = currTime - vE1Time;

        x = x + (((uVelocityFactor/1.5)*vE1Vel.x)*movTime);
        y = y + ((uVelocityFactor*vE1Vel.y)*movTime) + (0.5*uAceleration*movTime*movTime);
    }
    return vec2(x,y);
}

void main(){
    float currTime = uTime - vInitialTime;
    gl_Position.w = 1.0;
    gl_PointSize = 5.0;
    gl_Position.xy = currentPos(currTime);
    fColor = vColor;
}
</script>
<script id="vertex-shader-line" type="x-shader/x-vertex">
    attribute vec4 vPosition;
    attribute vec4 vLineColor;
    varying vec4 fColor;
    void main(){
        gl_Position = vPosition;
        gl_PointSize = 8.0;
        fColor = vLineColor;
    }
</script>
<script id="fragment-shader" type="x-shader/x-fragment">
precision mediump float;
varying vec4 fColor;
void main() {
    //
    // Changes the color of the triangle
    //
    gl_FragColor = fColor;


    // Changes the square point to a round one
    float r = 0.0;
    vec2 cxy = 2.0 * gl_PointCoord - 1.0;
    r = dot(cxy, cxy);
    if (r > 1.0) {
        discard;
    }
}
</script>
<script type="text/javascript" src="../Common/webgl-utils.js"></script>
<script type="text/javascript" src="../Common/initShaders.js"></script>
<script type="text/javascript" src="../Common/MV.js"></script>
<script type="text/javascript" src="fireworks.js"></script>
</head>
<body>
    <title>Triangle</title>
    <canvas id="gl-canvas" width="1024" height="600">
        Oops... your browser doesn't support the HTML5 canvas element"
    </canvas>
</body>
</html>